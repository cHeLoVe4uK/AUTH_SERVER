# Сервис аутентификации на Go, реализованный с помощью токенов
Проект является сервером аутентификации (частью сервера), предоставляющим функционал аутентификации, основанный на Access и Refresh tokens.  

Приложение взаимодействует с БД (в нашем случае Postgres).

## Как работать с приложением (запросы, которые поддерживает):
Первый маршрут выдает пару Access, Refresh токенов для пользователя с идентификатором (GUID) указанным в параметре запроса.  

Второй маршрут выполняет Refresh операцию на пару Access, Refresh токенов.  

1. `http://localhost:8080/user/auth/:GUID`- создание пользователя или добавление новой записи в БД, основанной на GUID (уникальный 128-битный идентификатор) указанном в параметре запроса. Так же запрос создает Access и Refresh tokens и выдает их пользователю.  
В тексте GUID записывается в виде строки из тридцати двух шестнадцатеричных цифр, разбитой на группы дефисами.  
Вместо localhost будет использоваться другое доменное имя или IP адрес в случае развертывания приложения на удаленном сервере.  
Этот запрос поддерживает только HTTP метод: POST

    Пример запроса:

    `http://localhost:8080/user/auth/G5725b634-374f-4c6b-b7c1-d8c947090469` - получение токенов на основе GUID


2. `http://localhost:8080/user/refresh` - получение новых токенов. Будут выданы в случае передачи пары токенов (которые выдавались вместе). Запрос будет успешен, если Access token будет передан в Authorization Header в виде "Bearer YOUR_ACCESS_TOKEN", а Refresh token формата JSON в body запроса.  
При этом, если токены были как-то изменены, переданы токены, которые шли не в паре, время действия Refresh token истекло, запрос будет неудачным.  
Вместо localhost будет использоваться другое доменное имя или IP адрес в случае развертывания приложения на удаленном сервере.  
Этот запрос поддерживает только HTTP метод: POST
    
    Пример запроса:

    `http://localhost:8080/info/refresh` - получение новой пары токенов
    ```bash
    {
    # Refresh token, который нужно использовать
    "refresh_token": "value_of_token"
    }
    ```

## Информация для разработчиков:
Для запуска у себя приложния, вы должны указать в командной строке аргумент -path, который представляет собой путь до файла с конфигурацией в формате .toml и именем api.
По умолчанию будет использоваться путь api_config/api.toml

## Конфигурационный файл должен иметь следующий вид:
```bash
# Данные по порту, на котором будет работать сервер и время жизни токенов
bind_addr="8080" # Порт может быть любым
acces_token_live="10m" # Время жизни может быть любым
refresh_token_live="43200m" # Время жизни может быть любым

# Данные для работы с БД
database_uri="host=your_host port=your_port user=your_user_name password=your_password dbname=your_db_name sslmode=disable" # подставлять свои значения
driver_name="postgres"
user_table="users" # Необязательно, чтобы таблица называлась именно так

# Секретный код для токенов
secret_key="SuperSecretniyParol" # Пароль для подписания токенов, может быть любым
```

## Так же в проекте можно накатывать и откатывать миграции БД, если они у вас поддерживаются, командами:
```bash
migrate -path <path_to_dir_with_migrations> -database "postgres://localhost:5432/your_db_name?sslmode=disable&user=your_user_name&password=your_password" up

migrate -path <path_to_dir_with_migrations> -database "postgres://localhost:5432/your_db_name?sslmode=disable&user=your_user_name&password=your_password" down
```





